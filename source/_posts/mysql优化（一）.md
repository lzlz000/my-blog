---
title: mysqlä¼˜åŒ–é—®é¢˜ï¼ˆä¸€ï¼‰æ…¢æŸ¥è¯¢
date: 2019-06-25 20:24:03
tags: [mysql]
typora-root-url: ../
---

[lzlz000çš„ä¸ªäººç©ºé—´](lzlz000.github.io)

æ€»ç»“ä¸€ä¸‹æœ€è¿‘å­¦ä¹ æ•´ç†çš„mysqlä¼˜åŒ–é—®é¢˜ ðŸ˜€

æˆ‘æ„Ÿè§‰mysqlä¼˜åŒ–ç‰¹åˆ«åƒçœ‹ç—…ï¼šé€šè¿‡æ…¢æŸ¥è¯¢æ¥å®šä½ç—‡çŠ¶ï¼Œæ‰§è¡Œè®¡åˆ’åˆ™æ˜¯æ£€æµ‹é¡¹ç›®-CT,Xå…‰,éªŒè¡€...ï¼Œsqlä¼˜åŒ–å°±æ˜¯æ²»ç–—æ‰‹æ®µã€‚

## æ…¢æŸ¥è¯¢

å³æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œæ˜¯æŒ‡mysqlè®°å½•æ‰€æœ‰æ‰§è¡Œè¶…è¿‡long_query_timeå‚æ•°è®¾å®šçš„æ—¶é—´é˜ˆå€¼çš„SQLè¯­å¥çš„æ—¥å¿—ã€‚è¯¥æ—¥å¿—èƒ½ä¸ºSQLè¯­å¥çš„ä¼˜åŒ–å¸¦æ¥å¾ˆå¥½çš„å¸®åŠ©

é»˜è®¤æƒ…å†µä¸‹ï¼Œæ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯å…³é—­çš„ï¼Œè¦ä½¿ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—åŠŸèƒ½ï¼Œé¦–å…ˆè¦å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—åŠŸèƒ½ã€‚

**é€šè¿‡ä¸‹é¢å‘½ä»¤æŸ¥çœ‹ä¸‹çš„é…ç½®ï¼š**

show VARIABLES like '%é…ç½®å˜é‡%'

**æ…¢æŸ¥è¯¢ç›¸å…³é…ç½®ä¿¡æ¯ï¼š**

- slow_query_log å¯åŠ¨åœæ­¢æŠ€æœ¯æ…¢æŸ¥è¯¢æ—¥å¿—
- slow_query_log_file æŒ‡å®šæ…¢æŸ¥è¯¢æ—¥å¿—å¾—å­˜å‚¨è·¯å¾„åŠæ–‡ä»¶ï¼ˆé»˜è®¤å’Œæ•°æ®æ–‡ä»¶æ”¾ä¸€èµ·ï¼‰
- long_query_time æŒ‡å®šè®°å½•æ…¢æŸ¥è¯¢æ—¥å¿—SQLæ‰§è¡Œæ—¶é—´å¾—ä¼å€¼ï¼ˆå•ä½ï¼šç§’ï¼Œé»˜è®¤10ç§’ï¼‰
- log_queries_not_using_indexes  æ˜¯å¦è®°å½•æœªä½¿ç”¨ç´¢å¼•çš„SQL
- log_output æ—¥å¿—å­˜æ”¾çš„åœ°æ–¹ã€TABLEã€‘ã€FILEã€‘ã€FILE,TABLEã€‘

```TEXT
-- æ…¢æŸ¥è¯¢æ²¡æœ‰å¼€å¯
mysql> SHOW VARIABLES LIKE '%slow_query_log%';
+---------------------+--------------------------------------+
| Variable_name       | Value                                |
+---------------------+--------------------------------------+
| slow_query_log      | OFF                                  |
| slow_query_log_file | /var/lib/mysql/21502193a9d9-slow.log |
+---------------------+--------------------------------------+

-- å¼€å¯æ…¢æŸ¥è¯¢åŠŸèƒ½
mysql> SET GLOBAL  slow_query_log=true;
Query OK, 0 rows affected (0.09 sec)

-- é»˜è®¤10ç§’ï¼Œè¿™é‡Œä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿è®¾ç½®ä¸º0
mysql> set global long_query_time=0;   
Query OK, 0 rows affected (0.05 sec)

```

